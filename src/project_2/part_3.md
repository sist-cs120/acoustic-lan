## Part 3. (2 points) CSMA

In order to efficiently support multiple nodes in the shared communication medium, their transmissions should be carefully coordinated. There are many different MAC protocols. The one we choose in _Athernet_ is CSMA, which is widely used in Ethernet and Wi-Fi.

**CSMA Protocol**. The intuition of CSMA protocol can be simply put as 'listen before talk'. The lecture and the textbook have covered it quite well. The state machine of CSMA protocol is shown in Figure 5. Check more information from references [1-5].

![](RackMultipart20220302-4-19oxl2x_html_391de21741456ff7.png)

Figure 5 CSMA+ACK State Machine [1]

**Frame Format**. In order to support multiple nodes, each node must have a unique destination identifier, which contributes the destination and source address in MAC frames. Using 8 bits for each address field is suggested. A type field is very useful for differentiating different kinds of frames, e.g., ACKs and normal data frames. Using 4 bits for type field is suggested. Finally, the maximum MAC payload must be limited, otherwise, the network may have large delay (see Part5).

![](RackMultipart20220302-4-19oxl2x_html_1644dc6d193c2200.png)

Figure 6 Frame Format

**Network with Jamming**. Using your accessories to connect 2 nodes like Part1, so the nodes are able to hear each other. Additionally, as shown in Figure 7, we introduce a jamming source to test the CSMA mechanism. Each node should be able to hear the output from the Jamming source, which intermittently plays high-power noise signals. The detailed parameters of the jamming source are coded in the JammingWav.m. Check them carefully to tune the parameters of the CSMA design. The key point is that, as CSMA is enabled in the two nodes, the communication should be able to work under the silent intervals of the Jamming source.

We go a little bit further about the Figure 7. First, the jamming signal is generated by a sound card. The signal is first split by a Tee and then merged with Rx signals of the nodes. The term 'merge' means a mix of two electronic waves. In the ideal case when the DC levels of these nodes are the same, 'merge' simply means sum or superposition. Second, another important implication of Figure 7 is that node1/2 can hear the signal generated by themselves. This is because the Tee is an undirected device. When the Tx signal by node 1 arrives at the Tee of node 2, it also is split and fed to the direction for the Jamming src. At the Tee of the Jamming src, that signal again split and final loop back to the Rx interface of node1. The same situation happens for the Tx signal of noted. I want to emphasize is that this is a feature rather than a bug of the topology. As when nodes can hear the transmission of themselves, there are no possibilities for full duplex implementations, which is why we use CSMA in early Ethernet and Wi-Fi.

![](RackMultipart20220302-4-19oxl2x_html_ad7271e1df1dcfb0.png)

Figure 7 Network Topology

Checkpoints:

The group provides two devices: NODE1, NODE2 connected by wires.

TAs provide one Jamming source. The jamming source is generated by JammingWav.m.

The group provides the interface to connect the jamming source.

The topology is shown in Figure 7.

CK1(2 points). 'INPUT1to2.bin' of 6250 Bytes and 'INPUT2to1.bin' of 5000 Bytes are provided.

NODE1: transmits INPUT1to2.bin to NODE2, store the received file to OUTPUT2to1.bin

NODE2: transmits INPUT2to1.bin to NODE1, store the received file to OUTPUT1to2.bin

Jamming Src: play 'Jamming.wav'

Jamming Src starts first. The transmission of NODE2 must be started immediately after the start of NODE1. The transmission of NODE2 must be finished before NODE1. The received files must be error free. The rank of Part7 is determined by the transmission time of NODE1.

The transmission of NODE1 must be finished within 120 seconds.

| Transmission Time | Points |
| --- | --- |
| [0, 60s] | 100% |
| (60s, 90s] | 80% |
| (90s, 120s] | 50% |
| >120s | 0% |

TAs compare the difference between INPUT\*.bin and OUTPUT\*.bin:

| 100% | \*100% |
| --- | --- |
| <100% | \*0% |

CK2(2 points). Redo CK1. TAs can unplug one of the wires, and transmitter should be able to identify the event and display 'link error'.
